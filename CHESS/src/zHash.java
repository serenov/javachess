public class zHash {
    

    static long board[][] = new long[64][13];
    static long castling[][] = new long[2][2];
    static long turn[] = new long[2];

    public static void INIT(){
         long randomarr[] = {
79078812345578752l, 58507312927341008l, 25530090364082236l, 69534059500763232l, 4649649007650292l, 29619345237000904l, 80792235528074000l, 29861208168934384l, 17258776841165224l, 16490859423804394l, 27133788971989l, 78446841607651664l, 60174838323583744l, 20960263692772340l, 62714151554553144l, 49861703491523568l, 65544981156126200l, 91834966333402864l, 23647259698478760l, 99727845848157904l, 67063441055574856l, 80398644923920976l, 83558265592815888l, 9355246932598670l, 293946053771843l, 93369251645438544l, 65943963881769760l, 23871936370522816l, 63219792742624872l, 52624759408894480l, 29946486070940892l, 72080682421758960l, 78052509111064752l, 9001967391958166l, 87905580920833104l, 37076037490123680l, 29411973352063160l, 86086928115968480l, 50596186918137384l, 8081340793860858l, 53697964042835488l, 49153856534206240l, 93184080303538896l, 46016068397425248l, 19805122590097924l, 4272679618058961l, 20576984690634748l, 37979652906257920l, 72290321073081184l, 33093620032058568l, 12118074288543456l, 99138767717118048l, 4683475922131342l, 59930562966637216l, 42463238496753512l, 4430724679477482l, 92839894477364416l, 29503125574948620l, 8003129000245002l, 97046550665959376l, 46064241186385600l, 46060774811615232l, 36335447832133128l, 25832984212560084l, 27193265840549708l, 87600465983470560l, 20062513817895112l, 9553482324717300l, 51906452448192744l, 62502697041720288l, 95583656753395200l, 12374047259602904l, 2240795626281932l, 20149021856971460l, 82571528965848160l, 41990546279578264l, 79617917253204736l, 61947490766239464l, 10465962760237558l, 49489891102165536l, 78648791952146864l, 24680616359748840l, 84588496450163072l, 18338285442895920l, 84563376790541280l, 24203867499569276l, 86375288733127936l, 78815507690995584l, 84319451797447680l, 54260917466224104l, 59745592246500592l, 73764971211841936l, 34277031631976628l, 32545143881373396l, 8767548334089037l, 31705114915861220l, 45781731966311392l, 74125203124856256l, 20552601159240304l, 74148409812333120l, 34082513070105712l, 50965738791745128l, 31704282006415464l, 95400096131890368l, 25716227035098016l, 65512603682973256l, 76666750650076480l, 5159521870227846l, 34823466877694108l, 26175210998538888l, 91962943899704048l, 16922743075913216l, 99817222782697424l, 63026964599433432l, 1581714741772144l, 98485810762688624l, 18407860058532612l, 63157961178538248l, 75667929522025184l, 74773980496846336l, 31195034370183096l, 36852438571887976l, 37188945040388408l, 87772841635600864l, 81869112591949568l, 48126755309211944l, 89395487937771920l, 73513145398441152l, 25521738908821168l, 56151941909918368l, 50664444568584208l, 11861883147789442l, 65647226581120832l, 17698150804415758l, 12705629919697836l, 41297995493144472l, 75123452661097152l, 94976605887503376l, 83134098984994336l, 7901792849729861l, 96792993200646800l, 98117978665501280l, 34054160227461416l, 35463032431381060l, 25222261768700784l, 67014316927896264l, 54570692058151784l, 61913313903714880l, 42798425266620240l, 63365006979615336l, 97037975968568528l, 86214280877393136l, 20530939615795828l, 505517332560001l, 14375752007458730l, 9383873738928228l, 96756536802847920l, 85960889117760672l, 8926724196301428l, 33518654444488384l, 15403567917154160l, 89654352211602656l, 52099319071827344l, 3471042662631396l, 39553594329649632l, 79314549531550160l, 88433971876397360l, 37266021993683432l, 55745192404306688l, 83863317191025264l, 7750795074597816l, 93392742275857136l, 49796953053259032l, 55429105285818712l, 54681001493632440l, 65782106053652048l, 65883644355393344l, 1119490319050198l, 46153961620064520l, 80582360969757744l, 57181639190095080l, 46799471010618496l, 84306354882693440l, 92770335061603936l, 98606626804368672l, 76860534784338848l, 84799340356204912l, 45186879016988280l, 59998744665270312l, 66328764036213424l, 88674267611757808l, 57760770007132512l, 31567231692973464l, 84648537241915264l, 89646958842141808l, 60486135947357488l, 52488817026288712l, 4091626847217888l, 88135077015086864l, 70144256235921544l, 18260972645026196l, 89979845262804656l, 78332714081385504l, 37811367309042144l, 32743335398215424l, 84772591815134416l, 85290785691130192l, 61869874056691680l, 26777483980225436l, 23559006701164396l, 95231402474792688l, 69541144249655536l, 86857414343077648l, 34607644833512428l, 64218870267968440l, 18883878396353748l, 24530005664745556l, 85364958848697216l, 47829574726675840l, 62752802040272984l, 70036840605882176l, 31657056935628112l, 67607449452308968l, 46388186990646584l, 92165763837623936l, 15837564954717830l, 18861328416425704l, 81107551326407488l, 30362588335299124l, 38237662125591664l, 28754979394958168l, 47996600649703928l, 74860400137834416l, 95512645236604704l, 93660160261235520l, 37547317250845424l, 45915937877965088l, 39342675089697600l, 60387556861372072l, 23866830732047260l, 4199551275406765l, 59433615605227216l, 67180015369205704l, 5381503957625444l, 70967296795797408l, 35877183060498808l, 27246985574221892l, 17886497249881716l, 48850708974686840l, 37667868564093088l, 20138648802894844l, 40341751228754432l, 11931883223001504l, 66537434557684760l, 54402713783724536l, 68991209247036592l, 77228492280477840l, 58256002801283856l, 78736418126144576l, 31182848725447032l, 78795375427569568l, 57162063003534416l, 48240772355642592l, 46692827542492632l, 40356457139750800l, 73922054559374608l, 97403655781856624l, 21407917053791924l, 82712646715759136l, 21383343350108540l, 32082851980084216l, 75896087791005056l, 8128552152864932l, 98872833577115456l, 29029716876749824l, 69695974187973696l, 75482737973123808l, 61406627911590520l, 23388612283162512l, 81081654896500016l, 17173377444482496l, 67014487630806816l, 72126853455949568l, 41610024038101736l, 51603160903552512l, 42746096046785344l, 4494387521676979l, 4933772573650275l, 13524322020506096l, 47914442427571288l, 9382010098379390l, 50163787930949000l, 58606689475295880l, 41744897575018560l, 63841379407702392l, 81490602190107792l, 98298764128371424l, 81836820761886656l, 77049709052142656l, 87825201634549104l, 86383719969449408l, 89707877469566944l, 9646486097028472l, 68895418410089408l, 9589413712313478l, 20179466080899200l, 29639107074876892l, 17534805400477116l, 31193381726787628l, 62474952026108232l, 82968883965367712l, 71826725224412344l, 98770941992862160l, 82640719818423248l, 89348364631120560l, 15317153380052684l, 55066473773012712l, 89263287542476480l, 22125471718197632l, 8685481494360137l, 84425019730494800l, 67444042625417552l, 94699469961377680l, 82063367653116896l, 86303377380815200l, 79606418017377584l, 55408337416580408l, 3617512260462274l, 92086878655320896l, 75948632582134672l, 87826613226378432l, 67062947579401944l, 31770069667700072l, 92218383613952496l, 24057339338374504l, 8449268866536064l, 13016561581152242l, 37974147656069160l, 4871258456627614l, 70862993238758008l, 96695348799898960l, 94611074824616000l, 62440938160381488l, 84615017875364688l, 40197906395434192l, 49167675805146248l, 58937030117422696l, 20032920142643628l, 32672411547540736l, 87292851417071744l, 87398416829384288l, 153638962694868l, 64768491283210040l, 56741045834173464l, 30057524021472448l, 31412844099711380l, 59567898976807920l, 91376596511015744l, 73696584629426896l, 21853105060405876l, 41083572220491368l, 54906652951377320l, 1630210808303978l, 8423708202489089l, 32041539848380008l, 23425312863389424l, 17554130870555796l, 7620804818965587l, 53617202097245128l, 76339869036247872l, 7769499254279544l, 37017319642117200l, 46379508252949312l, 6363404575359788l, 15186707570038104l, 29157821638218560l, 43903621364956992l, 90996201879758336l, 81032140298398320l, 73844398865523024l, 8344642189445994l, 90281740123016400l, 8325907296334667l, 80015279417731968l, 80722065610556352l, 48611320346840192l, 14968042772994584l, 44218775254380096l, 7746609069377097l, 81964658551414288l, 73665235663410464l, 49110910253937504l, 81728100068230176l, 26212052352710800l, 80949683959681648l, 92455832585290864l, 70435189439832392l, 6967008028430177l, 58186200687235344l, 64783935608843712l, 19734606354343064l, 66966506130546232l, 63733186704711184l, 52163371978154152l, 83419770123968304l, 53069365932073952l, 87317681821992416l, 39466421392963216l, 71845573905300664l, 21701422427154416l, 5204212686484599l, 29062982926168468l, 13818189014258386l, 68939561705219368l, 97881639048028128l, 70049196252055024l, 94645777445148064l, 29414886497458004l, 70761818820249896l, 13920043175774488l, 67338036873424624l, 16828613653434798l, 72778359846790192l, 74020479344223584l, 33649495197914180l, 98112535101589712l, 77793337730811888l, 68160510320620168l, 56993572534441304l, 3129221036445828l, 79364300709497104l, 66455346385051528l, 211388659571398l, 72295358318145504l, 50693491118107960l, 49752586389774144l, 77761357599583808l, 35624930824548884l, 38475711329030568l, 7934142249346887l, 74102665117008656l, 98427257454430576l, 91880782790374176l, 71931410098632472l, 7877709660443222l, 81258100353940400l, 76051109297665600l, 78467974122588352l, 14955640003596682l, 24710452161720620l, 83264349642373440l, 12344890080240966l, 82481168800788656l, 23244778977570712l, 34305774833678028l, 57509415097332720l, 90779846355776032l, 96496871959341472l, 57614374722881136l, 15198797257633024l, 10303026485307776l, 41364654532403344l, 44411362416708480l, 15126532091100652l, 56752788343678704l, 33663669234015224l, 4289184789545563l, 53979269162982592l, 29109088499307644l, 64254154192076152l, 87633769797658352l, 44418370216179296l, 42488488375388376l, 1280962841243615l, 98772167042698784l, 47330810836559400l, 20595782882225676l, 67530856701715792l, 96882381379564304l, 90250023124076704l, 30986935923720980l, 9899935219073696l, 70471620730712936l, 45667945856344160l, 30443733111026196l, 16577324190353648l, 75623812279123840l, 54385398358267064l, 37467577889375456l, 6789434609326028l, 48236679063535616l, 31098646089716396l, 64231941003945360l, 77812485970778528l, 36113284221421448l, 82095821394064768l, 21289950453698380l, 44449171769017800l, 48042413401708952l, 98237634858485808l, 54915667563163496l, 47278693698145232l, 83896746911540992l, 60322589634440352l, 89164616821827808l, 37727657551654560l, 92297261863028656l, 8487718185712090l, 22571182303899340l, 70372569121303552l, 536884231252410l, 82471607374629632l, 72857495163240848l, 45873007248967832l, 75225886118508992l, 35367266382732244l, 72110473013795776l, 51547786894966376l, 1516112198935948l, 59918225670335712l, 89590728484483552l, 40844726035276048l, 13780597774751768l, 43461938805021208l, 99669044021782144l, 77817905491042944l, 71269714746454392l, 85300421847665680l, 18343206818139356l, 48214605130336032l, 48534481211185408l, 68578831404775616l, 3369952289753297l, 4887356639759544l, 2302223506078571l, 77678415022453552l, 50253880796827944l, 71984857178965712l, 84009313291078640l, 91681119792278928l, 19167169918173188l, 79738756257783264l, 90340180955654144l, 64638872483678696l, 96330974761116400l, 39651615247898984l, 82891444812755936l, 24181351356905432l, 27471438025162576l, 98504619726823312l, 62474393860172624l, 81421835346127984l, 60670239215192664l, 28841905311701776l, 53588725493468128l, 47171515039176016l, 1261695374772264l, 23451636284286648l, 40244832004154544l, 92148435625566224l, 12385361955054142l, 61852254626171344l, 95581630646822176l, 72167977484672096l, 91385245968943088l, 7905617426959022l, 64621260526555544l, 63227615843007736l, 14453650115912964l, 79417004882854480l, 92021703383720512l, 15949468560458658l, 69749761644841400l, 2945239071559302l, 34832760107545624l, 44019892763973320l, 92680141951648304l, 30034514149790616l, 64030429519520728l, 7066193788952158l, 76110251854574672l, 44692708019357600l, 37999249395904464l, 34836338381364228l, 52983231535742712l, 36179330648218352l, 26151676153700964l, 66598206760994192l, 39154146587865744l, 46029480664343704l, 71518125928421672l, 47350899469049856l, 80204965941590832l, 23728481392158296l, 7410826750961397l, 30741186883350048l, 67587574695800480l, 41565160766845832l, 85159167497193520l, 87504156544169024l, 76649113737836960l, 25929998228687880l, 27433731024060048l, 7797733915709315l, 31926020084072416l, 59687678155054360l, 94820805000798208l, 15976675602738110l, 23550153180758792l, 98241804189253296l, 42078583820861784l, 87152295595143488l, 82692408976574576l, 20522910194079168l, 44900907990183392l, 66310054211623960l, 73676282664644016l, 5369078964544183l, 98033875902814800l, 42807871840594048l, 75725835304678128l, 83631839689356816l, 21235173828680332l, 25753813086300604l, 8269602557235400l, 66828253980424224l, 60835537522855928l, 99062612580404304l, 303967737293409l, 94273399888165040l, 41556293714474976l, 8916220581344603l, 16526564275668210l, 72365731300527200l, 5756391612926859l, 50904417677739488l, 30782332741065676l, 2061098010886775l, 75426987230008432l, 79297219849539632l, 80821837965150064l, 3559453736212103l, 86021042704509248l, 56701704425682144l, 47453547733181880l, 50841582131884296l, 70600033218095328l, 98781545351486912l, 75878717732606752l, 22931482229305720l, 17799338508928386l, 45768419049351192l, 97329669658876320l, 63623248057032048l, 87758428137309936l, 10170175374792390l, 15089170349002312l, 16899678831061704l, 46431513144497784l, 8381456941773180l, 90550738271517856l, 71383018980272208l, 70588809382183168l, 82828246732804352l, 2186673939705619l, 3896611854687792l, 83338160113125536l, 60828591167654144l, 53122689133121384l, 59579428093854368l, 3141238212915476l, 76527531363314608l, 71474981633875608l, 43983835914108240l, 28068116446306492l, 3065046394632420l, 81687728279153344l, 31200121288403960l, 31428495426367896l, 3561630054461306l, 24815881441373476l, 11289662681255120l, 14937442630965936l, 11556840882960596l, 71030296626816104l, 10171909372422650l, 51218000059255608l, 94212007605162464l, 98579155128457568l, 15598526645781852l, 48712568559208112l, 34889026987674476l, 10021765989570852l, 33961501103468884l, 88969484138738704l, 95642955356918784l, 18757785754085508l, 84420101197569568l, 18790769995867496l, 84716929707397296l, 66706971680284376l, 9195024853937628l, 27871536006508680l, 59303653833088536l, 27451599501743808l, 41866261120281088l, 6331071884948247l, 39638557692262736l, 8235719840468680l, 29124475419094152l, 55930157897552144l, 96915440048924832l, 88922426486358272l, 45664057992204096l, 23788722872282376l, 4566249737259931l, 26342396084682684l, 76769216887080704l, 38062433163355216l, 10122390388658920l, 8423925193012494l, 68632777015489896l, 51306364932639888l, 93175743839471008l, 64076781560068504l, 62560656471867056l, 39148467447181456l, 23883383962622584l, 22009179813943360l, 35953244005203712l, 59414997030080128l, 26010737060910928l, 64489223126659056l, 70318207562877056l, 49994685045083568l, 78683711892152048l, 40519224826295656l, 54557500978182872l, 32497908108783556l, 61821110609452968l, 86973282384880896l, 10384697870455118l, 93161651465804416l, 61644426492530344l, 55955590430885768l, 95966952762951312l, 32470643325424252l, 4712902535652874l, 61968954376534720l, 3749296962479498l, 10609483306659850l, 81607495056652672l, 43440000097656416l, 18907130637835344l, 67130187015961416l, 54688192772200192l, 79729641035380256l, 45986152598898824l, 60114066377449048l, 18274917191942908l, 16964368227310788l, 43027202985676872l, 52626437483780656l, 94152985148984000l, 33855945626691852l, 24836790042931180l, 72407097740943008l, 479930762908564l, 22134188196614836l, 10052330543515498l, 84509144436076448l, 27971253345675752l, 65299441214415064l, 90264461520528144l, 45993159936010056l, 93668413982856480l, 74108475933191520l, 93697011881854912l, 56803377449884128l, 19643237649990532l, 77539547195573984l, 808535024571643l, 81596913832444624l, 1668607962098023l, 73939340660844096l, 44667560650310120l, 93566731312381584l, 91186137876845904l, 18636615531553424l, 95067056736283968l, 83193541642578032l, 12827315684940400l, 61514368077799920l, 82081781993155280l, 82381295638675520l, 79295333275004960l, 50864361460963728l, 62135608297815248l, 77575571987279056l, 45590672665528296l, 88304898784782912l, 67634044060806520l, 24233598336982976l, 65364233798229544l, 53624776831557384l, 9830601404127704l, 29409207365552292l, 73607610237103712l, 18123337306415864l, 23833817236166176l, 39235601733429072l, 21940900273052864l, 30348622837944096l, 54525103380992280l, 53733258358193784l, 35434171544799420l, 89092622951634752l, 82645830063205088l, 92639887165623648l, 43199568387577856l, 15084660419140994l, 81425351863436480l, 52853869734763160l, 58916752767759936l, 95030991151093936l, 75859964415599216l, 30602155286011712l, 52005173055217232l, 99480711377414528l, 49116055966749560l, 29588080954512752l, 55332464658434424l, 69455122989631288l, 3519005365184713l, 40144169688521760l, 1149031174581360l, 25859697296579720l, 37202638339093072l
         };
        int count = 0;
        for(int i = 0; i < 64; i++){
            for(int j = 0; j < 13; j++){
                board[i][j] = randomarr[count++];
            }
        }
        for(int i = 0; i < 2; i++){
            for(int j = 0; j < 2; j++){
                castling[i][j] = randomarr[count++];
            }
            turn[i] = randomarr[count++];
        }

    }
    public static long genHash(bitboard b){
        long digest = 0;
        long piece;
        int pos;
        for(int i = 0; i < 12; i++){
            piece = b.getp(i);
            for(int j = bitboard.countBits(piece); j > 0; j--){
                pos = bitboard.getIndex(piece);
                digest ^= board[pos][i];
                piece &= ~(1l << pos);
            }
        }
        if(b.enpassant != 0) digest ^= board[bitboard.getIndex(b.enpassant)][12];
        
        pos = 2;

        for(int color = 0; color < 2; color++){
            if((b.Castling & pos) != 0){
                if((b.Castling & (pos >>> 1)) != 0 )digest ^= castling[color][0];
                if((b.Castling & (pos << 1)) != 0 )digest ^= castling[color][1];
            }
            pos = 16;
        }
        digest ^= turn[b.turn];
        return digest;
    }


    // public static boolean verify(long digest, long key){
    //     if(((digest ^ key) ^ ~key) == digest) return true;
    //     return false;
    // }

    // public static void setBoard(long digest, bitboard b){
    //     long pieces[] = b.refpieces();
    //     for(int pos = 0; pos < 64; pos++){
    //         for(int ID = 0; ID < 12; ID++){
    //             pieces[ID] = 0;
    //             if(verify(digest, board[pos][ID])){
    //                 pieces[ID] |= (1l << pos);
    //             }
    //         }
    //         if(verify(digest, board[pos][12]))
    //             b.enpassant |= (1l << pos);
    //     }
    //     b.updateEmpty();
    //     b.updateWB();
    //     if(verify(digest, turn[0])) b.turn = 0;
    //     else if(verify(digest, turn[1])) b.turn = 1;
    //     b.Castling = 0;
    //     if(verify(digest, castling[0][0])) b.Castling |= 3;
    //     if(verify(digest, castling[0][1])) b.Castling |= 6;
    //     if(verify(digest, castling[1][0])) b.Castling |= 6;
    //     if(verify(digest, castling[1][1])) b.Castling |= 6;
    // }

    public static void main(String args[]){
        //bitboard b = new bitboard("5K1b/1Bpkp3/1p6/3PpP2/2r2p2/2Q5/5q2/r6n w - - 0 1".split(" "));
        bitboard b = new bitboard();
        INIT();
        b.INIT();
        b.bitboardsInit();
        b.bitDisplay();

        for(int i = 0; i < 838; i++){
            System.out.print((long) (Math.random()* 100000000000000000l) + "l, ");
        }
    }

}
